import{am as b,d as L,$ as P,j as e,T as A,r as c,an as x,q as w,ao as y,a3 as B,a4 as v,n as E,p,t as R,x as Q,Q as q,G as F,ag as M,H as $,ap as G}from"./index-D-BZ1Xfu.js";function I(){const[t,s]=b(),o=L(u=>u.languages.value),l=u=>{const{target:{value:a}}=u;s(r=>(r.set("search",a),a||r.delete("search"),r))},{colorOne:k,colorTwo:i}=P();return e.jsx("div",{className:"px-5 flex justify-center",children:e.jsx(A,{sx:{width:"1000px",bgcolor:i,borderRadius:"5px"},label:o==="ko"?"유저 이름":"User name",onChange:l})})}function z({userObj:t}){const[s,o]=c.useState([]),[l,k]=c.useState([]),[i,u]=c.useState(null),[a,r]=c.useState(!1),[D,J]=b(),d=D.get("search"),N=20;c.useEffect(()=>{const U=async()=>{const h=w(E(p,"members"),v("points","desc"),B(N),y(i||"")),g=await R(h),m=g.docs.map((n,f)=>{if(s.indexOf(n)===-1)return f+1===g.docs.length&&u(n),{...n.data()}});if(o([...s,...m]),l.length===0){const n=Q(p,`members/${t.uid}`),T=(await q(n)).data();m.map((H,j)=>{H.uid===t.uid&&(m[j].rank=j+1)}),k([T])}r(!1)},C=async()=>{const h=w(E(p,"members"),v("points","desc"),y(i||"")),g=await R(h),m=g.docs.map((n,f)=>{if(console.log(s.indexOf(n)),s.indexOf(n)===-1)return f+1===g.docs.length&&u(n),{...n.data()}});o([...s,...m]),r(!1)};(a||s.length===0)&&U(),d&&(C(),console.log(d))},[a,d]);const S=()=>{if(document.documentElement.offsetHeight-(window.innerHeight+Math.round(document.documentElement.scrollTop))>250||a){console.log(document.documentElement.offsetHeight);return}else console.log("scroll"),r(!0)};return c.useEffect(()=>(window.addEventListener("scroll",S),()=>window.removeEventListener("scroll",S)),[a]),e.jsx("div",{className:"flex truncate justify-center",children:d?e.jsx("div",{className:"w-[1000px]",children:e.jsx(x,{userObj:t,elements:s,multiple:!0,userSearch:d,ranking:!0,handleUser:null})}):e.jsxs("div",{className:"w-[1000px]",children:[e.jsx(x,{userObj:t,elements:l,multiple:!1,userSearch:null,ranking:!0,handleUser:null}),e.jsx(x,{userObj:t,elements:s,multiple:!0,userSearch:null,ranking:!0,handleUser:null}),a&&e.jsx("div",{className:"flex justify-center text-2xl bg-light-2 dark:bg-dark-2 rounded",children:"로딩"})]})})}function O({userObj:t}){const s=L(l=>l.languages.value),o=F();return c.useEffect(()=>{o(M(5))}),e.jsxs(e.Fragment,{children:[e.jsx($,{icon:e.jsx(G,{}),title:s==="ko"?"유저 랭킹":"User Ranking"}),e.jsx(I,{}),e.jsx(z,{userObj:t})]})}export{O as default};
