import{b1 as L,d as R,_ as P,j as e,T as A,r as o,q as w,b2 as y,a2 as B,a3 as v,n as b,t as E,x as q,p as x,O as F,G as M,af as Q,H as G,b3 as I}from"./index-DUQkLhoJ.js";import{L as p}from"./Lists-r4jMpOAQ.js";import"./ban-v0OJBixS.js";function O(){const[n,s]=L(),c=R(u=>u.languages.value),l=u=>{const{target:{value:a}}=u;s(r=>(r.set("search",a),a||r.delete("search"),r))},{colorOne:k,colorTwo:i}=P();return e.jsx("div",{className:"px-5 flex justify-center",children:e.jsx(A,{sx:{width:"1000px",bgcolor:i,borderRadius:"5px"},label:c==="ko"?"유저 이름":"User name",onChange:l})})}function _({userObj:n}){const[s,c]=o.useState([]),[l,k]=o.useState([]),[i,u]=o.useState(null),[a,r]=o.useState(!1),[D,$]=L(),d=D.get("search"),N=20;o.useEffect(()=>{const U=async()=>{const h=w(b(x,"members"),v("points","desc"),B(N),y(i||"")),g=await E(h),m=g.docs.map((t,f)=>{if(s.indexOf(t)===-1)return f+1===g.docs.length&&u(t),{...t.data()}});if(c([...s,...m]),l.length===0){const t=q(x,`members/${n.uid}`),T=(await F(t)).data();m.map((H,j)=>{H.uid===n.uid&&(m[j].rank=j+1)}),k([T])}r(!1)},C=async()=>{const h=w(b(x,"members"),v("points","desc"),y(i||"")),g=await E(h),m=g.docs.map((t,f)=>{if(console.log(s.indexOf(t)),s.indexOf(t)===-1)return f+1===g.docs.length&&u(t),{...t.data()}});c([...s,...m]),r(!1)};(a||s.length===0)&&U(),d&&(C(),console.log(d))},[a,d]);const S=()=>{if(document.documentElement.offsetHeight-(window.innerHeight+Math.round(document.documentElement.scrollTop))>250||a){console.log(document.documentElement.offsetHeight);return}else console.log("scroll"),r(!0)};return o.useEffect(()=>(window.addEventListener("scroll",S),()=>window.removeEventListener("scroll",S)),[a]),e.jsx("div",{className:"flex truncate justify-center",children:d?e.jsx("div",{className:"w-[1000px]",children:e.jsx(p,{userObj:n,elements:s,multiple:!0,userSearch:d,ranking:!0,handleUser:null})}):e.jsxs("div",{className:"w-[1000px]",children:[e.jsx(p,{userObj:n,elements:l,multiple:!1,userSearch:null,ranking:!0,handleUser:null}),e.jsx(p,{userObj:n,elements:s,multiple:!0,userSearch:null,ranking:!0,handleUser:null}),a&&e.jsx("div",{className:"flex justify-center text-2xl bg-light-2 dark:bg-dark-2 rounded",children:"로딩"})]})})}function V({userObj:n}){const s=R(l=>l.languages.value),c=M();return o.useEffect(()=>{c(Q(5))}),e.jsxs(e.Fragment,{children:[e.jsx(G,{icon:e.jsx(I,{}),title:s==="ko"?"유저 랭킹":"User Ranking"}),e.jsx(O,{}),e.jsx(_,{userObj:n})]})}export{V as default};
