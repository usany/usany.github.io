import{j as e,r,U as v,W as y,O as N,at as T,N as E,b4 as I,X as k,Y as L,Z as B,a0 as V,V as W,aC as R,az as $,aA as O,aW as P,a2 as Q,b6 as q,ap as z}from"./index-B_d1dMZj.js";import{P as G}from"./PageTitle-CbwRuwRC.js";import{C as X,T as b}from"./TextField-B-g8UoeG.js";import{r as A,t as D,B as f,v as F,w as Y,G as Z}from"./index-CXRr2hgY.js";import{A as H,a as J,b as K,c as _}from"./accordion-CRjGOCma.js";import{L as M}from"./Lists-gBJfodmV.js";import{u as U,C as ee}from"./useCardsBackground-D3UMEnKp.js";function S({action:s,label:a}){return e.jsxs("div",{className:"px-5",children:[e.jsxs("span",{children:[s,": "]}),e.jsx(X,{label:a})]})}const se=({userObj:s})=>{const[a,n]=r.useState([]);r.useState();const m=v(y(N,"violations")),h=t=>{const c=t.id,i=E(N,`violations/${c}`);I(i);const l=[];a.map((o,d)=>{o.id!==c&&l.push(o),d+1===a.length&&n(l)}),alert("지웠습니다")};return r.useEffect(()=>{(async()=>{const c=[];(await k(m)).forEach(l=>{if(l.data().userUid===s.uid){const o=l.data(),d={id:l.id,...o};c.push(d)}n(c)})})()},[]),console.log(a),e.jsx(e.Fragment,{children:e.jsxs(A,{children:[e.jsx(D,{children:e.jsx(f,{variant:"outlined",form:"auth",children:"신고하기 내역"})}),e.jsxs(F,{className:"bg-light-3 dark:bg-dark-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-light-2 dark:bg-dark-2 h-2 w-[100px] rounded-full bg-muted",children:" "})}),e.jsx("div",{className:"flex justify-center pt-5",children:"신고하기 내역"}),e.jsx("div",{className:"p-5",children:a.length!==0?a.map((t,c)=>e.jsx("div",{children:e.jsx(H,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(J,{value:c.toString(),children:[e.jsx(K,{children:t.messageTitle}),e.jsxs(_,{children:[e.jsx("div",{children:t.message}),t!=null&&t.violationUser?e.jsxs("div",{children:[e.jsx("div",{className:"pt-5",children:"신고 등록 유저"}),e.jsx(M,{elements:[t.violationUser],multiple:!0,userSearch:!0,ranking:!1,handleUser:i=>console.log(i)})]}):e.jsx(T,{variant:"inset"}),e.jsx("div",{className:"flex pt-3 justify-center",children:e.jsx(f,{variant:"outlined",onClick:()=>h(t),children:"지우기"})})]})]})})})):e.jsx("div",{children:"신고하기 내역이 없습니다."})})]})]})})};function ae({violationUser:s,changeViolationUser:a}){const[n,m]=r.useState([]),[h,t]=r.useState([]),[c,i]=r.useState(""),l=d=>{const{target:{value:g}}=d;i(g)};r.useEffect(()=>{(async()=>{const g=v(y(N,"members"),W("points","desc")),C=(await k(g)).docs.map((j,x)=>{var p;return R($(O,`${(p=j.data())==null?void 0:p.uid}`)).then(u=>{t([...h,{url:u,index:x}])}).catch(u=>{console.log(u)}),{...j.data()}});m(C)})()},[]);const{color:o}=U();return e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsx(D,{className:"w-screen",onClick:()=>i(""),children:s?e.jsx(ee,{sx:{width:"100%",bgcolor:o},children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex flex-col justify-center",children:"신고 유저:"}),e.jsx("div",{className:"px-5",children:e.jsxs(L,{className:`bg-${((s==null?void 0:s.profileColor)||[]).indexOf("#")===-1?s==null?void 0:s.profileColor:"profile-blue"}`,children:[e.jsx(B,{src:s==null?void 0:s.profileImageUrl}),e.jsx(V,{className:"text-xl border-none",children:s==null?void 0:s.displayName[0]})]})}),e.jsx("div",{className:"flex flex-col justify-center",children:s.displayName})]})}):e.jsx(f,{sx:{width:"100%"},variant:"outlined",form:"auth",children:"신고 유저 등록"})}),e.jsxs(F,{className:"h-[50%] bg-light-3 dark:bg-dark-3",children:[e.jsx(b,{label:"유저 이름",onChange:l}),c&&e.jsx(Y,{className:"overflow-y-scroll",children:e.jsx("div",{className:"flex flex-col",children:e.jsx(Z,{children:e.jsx(M,{elements:n,multiple:!0,userSearch:c,ranking:!1,handleUser:d=>a(d)})})})})]})]}),s&&e.jsx(f,{sx:{width:"25%"},variant:"outlined",onClick:()=>a(null),children:"신고 등록 취소"})]})}function te({userObj:s,user:a}){const[n,m]=r.useState(""),[h,t]=r.useState(""),[c,i]=r.useState(!1),[l,o]=r.useState(null),[d,g]=r.useState(!0);r.useEffect(()=>{a&&d&&(o(a),g(!1))},[a]),r.useEffect(()=>{i(!!(n&&h))},[n,h]);const w=async()=>{try{await P(y(N,"violations"),{userUid:s.uid,userName:s.displayName,messageTitle:n,message:h,violationUser:l}),alert("등록되었습니다"),m(""),t("")}catch(x){console.log(x)}},C=x=>{const{target:{name:p,value:u}}=x;t(u)},j=x=>{const{target:{name:p,value:u}}=x;m(u)};return e.jsx(e.Fragment,{children:e.jsxs("form",{id:"auth",children:[e.jsx("div",{className:"flex justify-center pt-5 px-5",children:e.jsx(b,{label:"신고하기 제목",multiline:!0,value:n,onChange:j,variant:"outlined",fullWidth:!0})}),e.jsx("div",{className:"flex justify-center pt-5 px-5",children:e.jsx(b,{label:"신고하기 내용",multiline:!0,rows:5,value:h,onChange:C,variant:"outlined",fullWidth:!0})}),e.jsx("div",{className:"flex pt-3 px-5 gap-1",children:e.jsx(ae,{violationUser:l,changeViolationUser:x=>o(x)})}),e.jsxs("div",{className:"flex justify-center pt-2.5",children:[e.jsx(se,{userObj:s}),c?e.jsx(f,{variant:"outlined",form:"auth",onClick:w,children:"전송"}):e.jsx(f,{variant:"outlined",form:"auth",disabled:!0,children:"전송"})]})]})})}function xe({userObj:s}){const a=Q(),{state:n}=q();return r.useEffect(()=>{a(z(5))}),e.jsxs("div",{children:[e.jsx(G,{title:"신고하기"}),e.jsx(S,{action:"발신",label:s.displayName}),e.jsx(S,{action:"수신",label:"담당자"}),e.jsx(te,{userObj:s,user:n==null?void 0:n.user})]})}export{xe as default};
