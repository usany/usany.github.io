import{d as $,x as B,v as k,r as v,w as T,a as _,b as a,j as t,z as y,n as j,b1 as ie,b2 as se,B as w,J as Q,L as ce,au as le,ay as de,M as pe,aI as Z,aJ as O,V as E,W as L,X as Y,aX as ue,af as d}from"./index-64efo2t5.js";import{B as p}from"./Button-BlGdsvjs.js";import{w as W}from"./webSocket-BpFYzTQr.js";function xe(e){return B("MuiCardContent",e)}$("MuiCardContent",["root"]);const fe=["className","component"],he=e=>{const{classes:o}=e;return j({root:["root"]},xe,o)},me=k("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,o)=>o.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),Oe=v.forwardRef(function(o,n){const r=T({props:o,name:"MuiCardContent"}),{className:i,component:l="div"}=r,s=_(r,fe),c=a({},r,{component:l}),f=he(c);return t.jsx(me,a({as:l,className:y(f.root,i),ownerState:c,ref:n},s))});function Ce(e){return B("MuiCardMedia",e)}$("MuiCardMedia",["root","media","img"]);const ve=["children","className","component","image","src","style"],ge=e=>{const{classes:o,isMediaComponent:n,isImageComponent:r}=e;return j({root:["root",n&&"media",r&&"img"]},Ce,o)},De=k("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:n}=e,{isMediaComponent:r,isImageComponent:i}=n;return[o.root,r&&o.media,i&&o.img]}})(({ownerState:e})=>a({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},e.isMediaComponent&&{width:"100%"},e.isImageComponent&&{objectFit:"cover"})),ke=["video","audio","picture","iframe","img"],Me=["picture","img"],eo=v.forwardRef(function(o,n){const r=T({props:o,name:"MuiCardMedia"}),{children:i,className:l,component:s="div",image:c,src:f,style:u}=r,R=_(r,ve),x=ke.indexOf(s)!==-1,h=!x&&c?a({backgroundImage:`url("${c}")`},u):u,I=a({},r,{component:s,isMediaComponent:x,isImageComponent:Me.indexOf(s)!==-1}),A=ge(I);return t.jsx(De,a({className:y(A.root,l),as:s,role:!x&&c?"img":void 0,ref:n,style:h,ownerState:I,src:x?c||f:void 0},R,{children:i}))});function ye(e){return B("MuiDialog",e)}const V=$("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),Ie=v.createContext({}),Ne=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],Se=k(ie,{name:"MuiDialog",slot:"Backdrop",overrides:(e,o)=>o.backdrop})({zIndex:-1}),We=e=>{const{classes:o,scroll:n,maxWidth:r,fullWidth:i,fullScreen:l}=e,s={root:["root"],container:["container",`scroll${w(n)}`],paper:["paper",`paperScroll${w(n)}`,`paperWidth${w(String(r))}`,i&&"paperFullWidth",l&&"paperFullScreen"]};return j(s,ye,o)},we=k(se,{name:"MuiDialog",slot:"Root",overridesResolver:(e,o)=>o.root})({"@media print":{position:"absolute !important"}}),$e=k("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,o)=>{const{ownerState:n}=e;return[o.container,o[`scroll${w(n.scroll)}`]]}})(({ownerState:e})=>a({height:"100%","@media print":{height:"auto"},outline:0},e.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},e.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),Re=k(Q,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,o)=>{const{ownerState:n}=e;return[o.paper,o[`scrollPaper${w(n.scroll)}`],o[`paperWidth${w(String(n.maxWidth))}`],n.fullWidth&&o.paperFullWidth,n.fullScreen&&o.paperFullScreen]}})(({theme:e,ownerState:o})=>a({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},o.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},o.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!o.maxWidth&&{maxWidth:"calc(100% - 64px)"},o.maxWidth==="xs"&&{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${V.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},o.maxWidth&&o.maxWidth!=="xs"&&{maxWidth:`${e.breakpoints.values[o.maxWidth]}${e.breakpoints.unit}`,[`&.${V.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[o.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},o.fullWidth&&{width:"calc(100% - 64px)"},o.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${V.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),be=v.forwardRef(function(o,n){const r=T({props:o,name:"MuiDialog"}),i=ce(),l={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{"aria-describedby":s,"aria-labelledby":c,BackdropComponent:f,BackdropProps:u,children:R,className:x,disableEscapeKeyDown:h=!1,fullScreen:I=!1,fullWidth:A=!1,maxWidth:g="sm",onBackdropClick:C,onClick:m,onClose:M,open:N,PaperComponent:z=Q,PaperProps:U={},scroll:b="paper",TransitionComponent:P=de,transitionDuration:G=l,TransitionProps:oe}=r,te=_(r,Ne),F=a({},r,{disableEscapeKeyDown:h,fullScreen:I,fullWidth:A,maxWidth:g,scroll:b}),X=We(F),q=v.useRef(),ne=S=>{q.current=S.target===S.currentTarget},re=S=>{m&&m(S),q.current&&(q.current=null,C&&C(S),M&&M(S,"backdropClick"))},H=le(c),ae=v.useMemo(()=>({titleId:H}),[H]);return t.jsx(we,a({className:y(X.root,x),closeAfterTransition:!0,components:{Backdrop:Se},componentsProps:{backdrop:a({transitionDuration:G,as:f},u)},disableEscapeKeyDown:h,onClose:M,open:N,ref:n,onClick:re,ownerState:F},te,{children:t.jsx(P,a({appear:!0,in:N,timeout:G,role:"presentation"},oe,{children:t.jsx($e,{className:y(X.container),onMouseDown:ne,ownerState:F,children:t.jsx(Re,a({as:z,elevation:24,role:"dialog","aria-describedby":s,"aria-labelledby":H},U,{className:y(X.paper,U.className),ownerState:F,children:t.jsx(Ie.Provider,{value:ae,children:R})}))})}))}))});function Pe(e){return B("MuiDialogActions",e)}$("MuiDialogActions",["root","spacing"]);const Be=["className","disableSpacing"],Te=e=>{const{classes:o,disableSpacing:n}=e;return j({root:["root",!n&&"spacing"]},Pe,o)},_e=k("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:n}=e;return[o.root,!n.disableSpacing&&o.spacing]}})(({ownerState:e})=>a({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),je=v.forwardRef(function(o,n){const r=T({props:o,name:"MuiDialogActions"}),{className:i,disableSpacing:l=!1}=r,s=_(r,Be),c=a({},r,{disableSpacing:l}),f=Te(c);return t.jsx(_e,a({className:y(f.root,i),ownerState:c,ref:n},s))});function Ae(e){return B("MuiDialogContent",e)}$("MuiDialogContent",["root","dividers"]);const Ue=$("MuiDialogTitle",["root"]),Fe=["className","dividers"],Ee=e=>{const{classes:o,dividers:n}=e;return j({root:["root",n&&"dividers"]},Ae,o)},Le=k("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:n}=e;return[o.root,n.dividers&&o.dividers]}})(({theme:e,ownerState:o})=>a({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},o.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${Ue.root} + &`]:{paddingTop:0}})),ze=v.forwardRef(function(o,n){const r=T({props:o,name:"MuiDialogContent"}),{className:i,dividers:l=!1}=r,s=_(r,Fe),c=a({},r,{dividers:l}),f=Ee(c);return t.jsx(Le,a({className:y(f.root,i),ownerState:c,ref:n},s))}),Xe=({move:e,handleClose:o})=>t.jsxs(be,{open:e,onClose:o,children:[t.jsx(ze,{children:"로그인이 필요합니다"}),t.jsxs(je,{children:[t.jsx(p,{variant:"outlined",onClick:()=>{o()},children:t.jsx(pe,{to:"/",children:"로그인 페이지"})}),t.jsx(p,{variant:"outlined",onClick:o,autoFocus:!0,children:"닫기"})]})]});var J={},qe=O;Object.defineProperty(J,"__esModule",{value:!0});var ee=J.default=void 0,He=qe(Z()),Ye=t;ee=J.default=(0,He.default)((0,Ye.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var K={},Ve=O;Object.defineProperty(K,"__esModule",{value:!0});var D=K.default=void 0,Je=Ve(Z()),Ke=t;D=K.default=(0,Je.default)((0,Ke.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");function oo({msgObj:e,isOwner:o,uid:n,displayName:r,userObj:i,num:l,points:s}){const[c,f]=v.useState(!1),u=async x=>{const h=E(L,`num/${e.id}`),I=E(L,`members/${e.creatorId}`),g=(await Y(I)).data().messagingToken;if(x==="delete"){ue(h);const[C,...m]=counter;setCounter([...m])}else if(x==="confirm return"){d(h,{round:5});const C=E(L,`members/${e.creatorId}`),m=E(L,`members/${e.connectedId}`),M=await Y(C),N=await Y(m),z=M.data().done||[],U=N.data().done||[];if(e.text.choose==1){const b=M.data().borrowDoneCount||[],P=N.data().lendDoneCount||[];d(C,{points:l-e.point}),d(m,{points:s+e.point}),d(C,{borrowDoneCount:[...b,e.id]}),d(m,{lendDoneCount:[...P,e.id]}),W.emit("confirm return",{choose:e.text.choose,sendingToken:g,creatorId:e.creatorId,creatorName:e.displayName,connectedId:n,connectedName:r})}else{const b=M.data().lendDoneCount||[],P=N.data().borrowDoneCount||[];d(C,{points:l+e.point}),d(m,{points:s-e.point}),d(C,{lendDoneCount:[...b,e.id]}),d(m,{borrowDoneCount:[...P,e.id]}),W.emit("confirm return",{choose:e.text.choose,sendingToken:g,creatorId:e.creatorId,creatorName:e.displayName,connectedId:n,connectedName:r})}console.log("practice"),d(C,{done:[...z,e.id]}),d(m,{done:[...U,e.id]})}else x==="confirm"?(d(h,{round:3}),W.emit("confirm",{choose:e.text.choose,sendingToken:g,creatorId:e.creatorId,creatorName:e.displayName,connectedId:n,connectedName:r})):x==="returning"?(d(h,{round:4}),W.emit("returning",{choose:e.text.choose,sendingToken:g,creatorId:e.creatorId,creatorName:e.displayName,connectedId:n,connectedName:r})):x==="supporting"?i?(d(h,{round:2,connectedId:n,connectedName:r}),W.emit("supporting",{choose:e.text.choose,sendingToken:g,creatorId:e.creatorId,creatorName:e.displayName,connectedId:n,connectedName:r})):f(!0):x==="stop supporting"&&i&&(d(h,{round:1,connectedId:null,connectedName:null}),W.emit("stop supporting",{choose:e.text.choose,sendingToken:g,creatorId:e.creatorId,creatorName:e.displayName,connectedId:n,connectedName:r}))},R=()=>{f(!1)};return t.jsx(t.Fragment,{children:o?t.jsxs(t.Fragment,{children:[e.round===1&&t.jsx("div",{className:"flex flex-col justify-center",children:t.jsx(p,{variant:"outlined",onClick:()=>u("delete"),startIcon:t.jsx(ee,{}),children:"지우기"})}),e.round===2&&t.jsx(p,{variant:"outlined",onClick:()=>u("confirm"),startIcon:t.jsx(D,{}),children:"승낙 메시지 확인"}),e.round===3&&t.jsxs("div",{className:"flex justify-center",children:[e.text.choose==1&&t.jsx(p,{variant:"outlined",onClick:()=>u("returning"),startIcon:t.jsx(D,{}),children:"반납하기"}),e.text.choose==2&&t.jsxs(p,{variant:"outlined",disabled:!0,children:[e.connectedName," 님이 빌리는 중"]})]}),e.round===4&&t.jsxs("div",{className:"flex justify-center",children:[e.text.choose==1&&t.jsx(p,{variant:"outlined",disabled:!0,children:"주인에게 확인 중"}),e.text.choose==2&&t.jsx(p,{variant:"outlined",onClick:()=>u("confirm return"),startIcon:t.jsx(D,{}),children:"반납 완료 확인"})]})]}):t.jsxs(t.Fragment,{children:[e.round===1&&t.jsxs("div",{className:"flex justify-center",children:[t.jsx(p,{variant:"outlined",onClick:()=>u("supporting"),startIcon:t.jsx(D,{}),children:"승낙하기"}),t.jsx(Xe,{move:c,handleClose:R})]}),e.round===2&&t.jsxs("div",{className:"flex flex-col justify-center",children:[t.jsx(p,{variant:"contained",disabled:!0,children:"승낙 메시지 전송 완료"}),t.jsx(p,{variant:"outlined",onClick:()=>u("stop supporting"),startIcon:t.jsx(D,{}),children:"취소"})]}),e.round===3&&t.jsxs("div",{className:"flex justify-center",children:[e.text.choose==1&&t.jsxs(p,{variant:"outlined",disabled:!0,children:[e.displayName," 님이 빌리는 중"]}),e.text.choose==2&&t.jsx(p,{variant:"outlined",onClick:()=>u("returning"),startIcon:t.jsx(D,{}),children:"반납하기"})]}),e.round===4&&t.jsxs("div",{className:"flex justify-center",children:[e.text.choose==1&&t.jsx(p,{variant:"outlined",onClick:()=>u("confirm return"),endIcon:t.jsx(D,{}),children:"반납 완료 확인"}),e.text.choose==2&&t.jsx(p,{variant:"outlined",disabled:!0,children:"주인에게 확인 중"})]})]})})}export{oo as B,eo as C,je as D,be as a,ze as b,Oe as c,V as d};
