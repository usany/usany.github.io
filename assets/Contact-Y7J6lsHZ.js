import{j as e,r,U as v,W as C,O as N,ap as T,N as E,b0 as I,X as k,Y as L,Z as B,a0 as V,V as R,ay as W,av as $,aw as q,aS as O,a2 as P,b2 as Q,al as X}from"./index-Cf6F0sWa.js";import{P as Y}from"./PageTitle-CY7_sdra.js";import{C as Z,T as y}from"./TextField-DlgDMFox.js";import{i as A,j as D,B as f,k as F,l as z,q as G}from"./index-XRnWYvih.js";import{A as H,a as J,b as K,c as _}from"./accordion-BDX8gWBs.js";import{L as M}from"./Lists-CNDciqYz.js";import{u as U,C as ee}from"./useCardsBackground-Cdt3cPQE.js";function S({action:s,label:a}){return e.jsxs("div",{className:"px-5",children:[e.jsxs("span",{children:[s,": "]}),e.jsx(Z,{label:a})]})}const se=({userObj:s})=>{const[a,n]=r.useState([]);r.useState();const m=v(C(N,"violations")),h=t=>{const l=t.id,i=E(N,`violations/${l}`);I(i);const c=[];a.map((o,d)=>{o.id!==l&&c.push(o),d+1===a.length&&n(c)}),alert("지웠습니다")};return r.useEffect(()=>{(async()=>{const l=[];(await k(m)).forEach(c=>{if(c.data().userUid===s.uid){const o=c.data(),d={id:c.id,...o};l.push(d)}n(l)})})()},[]),console.log(a),e.jsx(e.Fragment,{children:e.jsxs(A,{children:[e.jsx(D,{children:e.jsx(f,{variant:"outlined",form:"auth",children:"신고하기 내역"})}),e.jsxs(F,{className:"bg-light-3 dark:bg-dark-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-light-2 dark:bg-dark-2 h-2 w-[100px] rounded-full bg-muted",children:" "})}),e.jsx("div",{className:"flex justify-center pt-5",children:"신고하기 내역"}),e.jsx("div",{className:"p-5",children:a.length!==0?a.map((t,l)=>e.jsx("div",{children:e.jsx(H,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(J,{value:l.toString(),children:[e.jsx(K,{children:t.messageTitle}),e.jsxs(_,{children:[e.jsx("div",{children:t.message}),t!=null&&t.violationUser?e.jsxs("div",{children:[e.jsx("div",{className:"pt-5",children:"신고 등록 유저"}),e.jsx(M,{elements:[t.violationUser],multiple:!0,userSearch:!0,ranking:!1,handleUser:i=>console.log(i)})]}):e.jsx(T,{variant:"inset"}),e.jsx("div",{className:"flex pt-3 justify-center",children:e.jsx(f,{variant:"outlined",onClick:()=>h(t),children:"지우기"})})]})]})})})):e.jsx("div",{children:"신고하기 내역이 없습니다."})})]})]})})};function ae({violationUser:s,changeViolationUser:a}){const[n,m]=r.useState([]),[h,t]=r.useState([]),[l,i]=r.useState(""),c=d=>{const{target:{value:g}}=d;i(g)};r.useEffect(()=>{(async()=>{const g=v(C(N,"members"),R("points","desc")),b=(await k(g)).docs.map((j,x)=>{var p;return W($(q,`${(p=j.data())==null?void 0:p.uid}`)).then(u=>{t([...h,{url:u,index:x}])}).catch(u=>{console.log(u)}),{...j.data()}});m(b)})()},[]);const{color:o}=U();return e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsx(D,{className:"w-screen",onClick:()=>i(""),children:s?e.jsx(ee,{sx:{width:"100%",bgcolor:o},children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex flex-col justify-center",children:"신고 유저:"}),e.jsx("div",{className:"px-5",children:e.jsxs(L,{className:`bg-${((s==null?void 0:s.profileColor)||[]).indexOf("#")===-1?s==null?void 0:s.profileColor:"profile-blue"}`,children:[e.jsx(B,{src:s==null?void 0:s.profileImageUrl}),e.jsx(V,{className:"text-xl border-none",children:s==null?void 0:s.displayName[0]})]})}),e.jsx("div",{className:"flex flex-col justify-center",children:s.displayName})]})}):e.jsx(f,{sx:{width:"100%"},variant:"outlined",form:"auth",children:"신고 유저 등록"})}),e.jsxs(F,{className:"h-[50%] bg-light-3 dark:bg-dark-3",children:[e.jsx(y,{label:"유저 이름",onChange:c}),l&&e.jsx(z,{className:"overflow-y-scroll",children:e.jsx("div",{className:"flex flex-col",children:e.jsx(G,{children:e.jsx(M,{elements:n,multiple:!0,userSearch:l,ranking:!1,handleUser:d=>a(d)})})})})]})]}),s&&e.jsx(f,{sx:{width:"25%"},variant:"outlined",onClick:()=>a(null),children:"신고 등록 취소"})]})}function te({userObj:s,user:a}){const[n,m]=r.useState(""),[h,t]=r.useState(""),[l,i]=r.useState(!1),[c,o]=r.useState(null),[d,g]=r.useState(!0);r.useEffect(()=>{a&&d&&(o(a),g(!1))},[a]),r.useEffect(()=>{i(!!(n&&h))},[n,h]);const w=async()=>{try{await O(C(N,"violations"),{userUid:s.uid,userName:s.displayName,messageTitle:n,message:h,violationUser:c}),alert("등록되었습니다"),m(""),t("")}catch(x){console.log(x)}},b=x=>{const{target:{name:p,value:u}}=x;t(u)},j=x=>{const{target:{name:p,value:u}}=x;m(u)};return e.jsx(e.Fragment,{children:e.jsxs("form",{id:"auth",children:[e.jsx("div",{className:"flex justify-center pt-5 px-5",children:e.jsx(y,{label:"신고하기 제목",multiline:!0,value:n,onChange:j,variant:"outlined",fullWidth:!0})}),e.jsx("div",{className:"flex justify-center pt-5 px-5",children:e.jsx(y,{label:"신고하기 내용",multiline:!0,rows:5,value:h,onChange:b,variant:"outlined",fullWidth:!0})}),e.jsx("div",{className:"flex pt-3 px-5 gap-1",children:e.jsx(ae,{violationUser:c,changeViolationUser:x=>o(x)})}),e.jsxs("div",{className:"flex justify-center pt-2.5",children:[e.jsx(se,{userObj:s}),l?e.jsx(f,{variant:"outlined",form:"auth",onClick:w,children:"전송"}):e.jsx(f,{variant:"outlined",form:"auth",disabled:!0,children:"전송"})]})]})})}function xe({userObj:s}){const a=P(),{state:n}=Q();return r.useEffect(()=>{a(X(5))}),e.jsxs("div",{children:[e.jsx(Y,{title:"신고하기"}),e.jsx(S,{action:"발신",label:s.displayName}),e.jsx(S,{action:"수신",label:"담당자"}),e.jsx(te,{userObj:s,user:n==null?void 0:n.user})]})}export{xe as default};
