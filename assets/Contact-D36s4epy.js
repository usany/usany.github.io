import{j as e,B as R,c as y,p as k,D as U,L as T,r as m,a as d,q as A,e as w,h as p,E as B,G as $,H as Q,I as V,J as W,K as C,g as L,f as M,N as q,u as O,T as N,O as G,Q as H,R as J,o as K,U as X,V as z,W as Y,b as Z,P as _,X as ee}from"./index-BRqkL7v_.js";import{R as se}from"./RankingListsTitle-mw7699Vk.js";function F({action:s,label:n}){return e.jsxs("div",{className:"flex gap-5 pt-1 px-5",children:[e.jsxs("div",{className:"flex items-center",children:[s,":"]}),e.jsx(R,{label:n})]})}function te(){const s=y(n=>n.profile.value);return s!=null&&s.certificated?e.jsx(k,{trigger:e.jsx(ae,{}),title:e.jsx(re,{}),content:e.jsx(ne,{})}):null}function E({elements:s,multiple:n,userSearch:t,ranking:c,handleUser:i}){return c?e.jsx(T,{elements:s,userSearch:t,multiple:n,handleUser:i}):e.jsx(U,{children:e.jsx(T,{elements:s,userSearch:t,multiple:n,handleUser:i})})}const ne=()=>{const[s,n]=m.useState([]),t=y(r=>r.profile.value),{noReport:c,reportingUser:i,remove:g}=d(),a=A(w(p,"violations")),j=r=>{const o=r.id,u=M(p,`violations/${o}`);q(u);const l=[];s.map((h,f)=>{h.id!==o&&l.push(h),f+1===s.length&&n(l)}),alert("지웠습니다")};return m.useEffect(()=>{(async()=>{const o=[];(await L(a)).forEach(l=>{if(l.data().userUid===(t==null?void 0:t.uid)){const h=l.data(),f={id:l.id,...h};o.push(f)}n(o)})})()},[]),s.length===0?e.jsx("div",{className:"flex justify-center p-5",children:e.jsx("div",{className:"rounded shadow-md bg-light-1 dark:bg-dark-1 p-5",children:c})}):e.jsx("div",{className:"p-5",children:s.map((r,o)=>e.jsx("div",{children:e.jsx(B,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs($,{value:o.toString(),children:[e.jsx(Q,{children:r.messageTitle}),e.jsxs(V,{children:[e.jsx("div",{children:r.message}),r!=null&&r.violationUser?e.jsxs("div",{children:[e.jsx("div",{className:"pt-5",children:i}),e.jsx(E,{elements:[r.violationUser],multiple:!0,userSearch:!0,ranking:!1,handleUser:u=>console.log(u)})]}):e.jsx(W,{variant:"inset"}),e.jsx("div",{className:"flex pt-3 justify-center",children:e.jsx(C,{variant:"outlined",onClick:()=>j(r),children:g})})]})]})})}))})},re=()=>{const{reportList:s}=d();return e.jsx(e.Fragment,{children:s})},ae=()=>{const{reportList:s}=d();return e.jsx(C,{variant:"outlined",form:"auth",children:s})};function ce(){const[s,n]=O(),[t,c]=m.useState({title:"",content:""}),[i,g]=m.useState(null),a=y(x=>x.profile.value),{sending:j,receiving:r,supervisor:o,send:u,reportTitle:l,reportContent:h,anonymousUser:f}=d();m.useEffect(()=>{(async()=>{const v=M(p,`members/${s.get("id")}`),S=(await G(v)).data();S&&g(S)})()},[s.get("id")]);const P=x=>{g(x)},I=async()=>{try{t.title&&t.content?(await H(w(p,"violations"),{userUid:(a==null?void 0:a.uid)||"비로그인",userName:(a==null?void 0:a.displayName)||"비로그인",messageTitle:t.title,message:t.content,violationUser:a!=null&&a.certificated?i:null}),alert("등록되었습니다"),c({title:"",content:""}),g(null)):alert("내용을 작성해주세요")}catch(x){console.log(x)}},b=x=>{const{target:{value:v,name:D}}=x;c({...t,[D]:v})};return e.jsxs("form",{id:"auth",children:[e.jsx(F,{action:j,label:a?a==null?void 0:a.displayName:f}),e.jsx(F,{action:r,label:o}),e.jsx("div",{className:"pt-5 px-5",children:e.jsx(N,{name:"title",sx:{display:"flex",justifyContent:"center"},label:l,multiline:!0,value:t.title,onChange:b,variant:"outlined",fullWidth:!0})}),e.jsx("div",{className:"pt-5 px-5",children:e.jsx(N,{name:"content",sx:{display:"flex",justifyContent:"center"},label:h,multiline:!0,rows:5,value:t.content,onChange:b,variant:"outlined",fullWidth:!0})}),e.jsx(ie,{violationUser:i,changeViolationUser:P}),e.jsxs("div",{className:"flex justify-center pt-2.5",children:[e.jsx(te,{}),e.jsx(C,{variant:"outlined",form:"auth",onClick:I,children:u})]})]})}function ie({violationUser:s,changeViolationUser:n}){const t=y(c=>c.profile.value);return t!=null&&t.certificated?e.jsxs("div",{className:"flex gap-5 pt-3 px-5",children:[e.jsx(k,{trigger:e.jsx(ue,{violationUser:s}),title:e.jsx(le,{}),content:e.jsx(oe,{changeViolationUser:n})}),s&&e.jsx(C,{variant:"outlined",onClick:()=>n(null),children:e.jsx(J,{})})]}):null}function oe({changeViolationUser:s}){const[n,t]=m.useState([]),[c,i]=m.useState(""),{userName:g}=d(),a=j=>{const{target:{value:r}}=j;i(r)};return m.useEffect(()=>{(async()=>{const r=A(w(p,"members"),K("points","desc")),u=(await L(r)).docs.map(l=>({...l.data()}));t(u)})()},[]),e.jsxs("div",{className:`flex flex-col p-5 ${!c&&"h-[60vh]"}`,children:[e.jsx(N,{label:g,onChange:a}),c&&e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx(se,{multiple:!0}),e.jsx(E,{elements:n,multiple:!0,userSearch:c,ranking:!1,handleUser:s})]})]})}function le(){const{searchUser:s}=d();return e.jsx(e.Fragment,{children:s})}const de=({violationUser:s,color:n})=>{const t=s!=null&&s.profileImage?s.profileImageUrl:s==null?void 0:s.defaultProfile,c=(s==null?void 0:s.displayName.slice(0,10))+"......",{reportingUser:i}=d();return e.jsx(X,{sx:{width:"100%",bgcolor:n},children:e.jsxs("div",{className:"flex justify-between p-3 gap-3",children:[e.jsx("div",{className:"flex items-center",children:i}),e.jsx(z,{children:e.jsx(Y,{src:t})}),e.jsx("div",{className:"flex items-center",children:c})]})})};function ue({violationUser:s}){const{colorTwo:n}=Z(),{registerReportingUser:t}=d();return s?e.jsx(de,{violationUser:s,color:n}):e.jsx("div",{className:"flex justify-center",children:e.jsx(C,{sx:{bgcolor:n,":hover":{bgcolor:n}},variant:"outlined",form:"auth",children:t})})}function ge(){const{report:s}=d();return e.jsxs(e.Fragment,{children:[e.jsx(_,{icon:e.jsx(ee,{}),title:s}),e.jsx(ce,{})]})}export{ge as default};
