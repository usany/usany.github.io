import{j as e,R,U,L as S,r as x,a as d,T as v,q as A,o as B,e as w,f as p,g as F,V as I,W as $,X as Q,b as V,B as N,c as C,v as L,H as W,Y as q,Z as O,_ as H,$ as X,a0 as Y,h as M,Q as Z,u as _,a1 as z,a2 as G,P as J,a3 as K}from"./index-Bhu-8f_a.js";import{R as ee}from"./RankingListsTitle-DdlHqr_0.js";function k({action:s,label:t}){return e.jsxs("div",{className:"flex gap-5 pt-1 px-5",children:[e.jsxs("div",{className:"flex items-center",children:[s,":"]}),e.jsx(R,{label:t})]})}function E({elements:s,multiple:t,userSearch:n,ranking:c,handleUser:i}){return c?e.jsx(S,{elements:s,userSearch:n,multiple:t,handleUser:i}):e.jsx(U,{children:e.jsx(S,{elements:s,userSearch:n,multiple:t,handleUser:i})})}function se({changeViolationUser:s}){const[t,n]=x.useState([]),[c,i]=x.useState(""),{userName:a}=d(),h=m=>{const{target:{value:r}}=m;i(r)};return x.useEffect(()=>{(async()=>{const r=A(w(p,"members"),B("points","desc")),g=(await F(r)).docs.map(l=>({...l.data()}));n(g)})()},[]),e.jsxs("div",{className:`flex flex-col p-5 ${!c&&"h-[60vh]"}`,children:[e.jsx(v,{label:a,onChange:h}),c&&e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx(ee,{multiple:!0}),e.jsx(E,{elements:t,multiple:!0,userSearch:c,ranking:!0,handleUser:s})]})]})}function te(){const{searchUser:s}=d();return e.jsx(e.Fragment,{children:s})}const ne=({violationUser:s,color:t})=>{const n=s!=null&&s.profileImage?s.profileImageUrl:s==null?void 0:s.defaultProfile,c=(s==null?void 0:s.displayName.slice(0,10))+"......",{reportingUser:i}=d();return e.jsx(I,{sx:{width:"100%",bgcolor:t},children:e.jsxs("div",{className:"flex justify-between p-3 gap-3",children:[e.jsx("div",{className:"flex items-center",children:i}),e.jsx($,{children:e.jsx(Q,{src:n})}),e.jsx("div",{className:"flex items-center",children:c})]})})};function re({violationUser:s}){const{colorTwo:t}=V(),{registerReportingUser:n}=d();return s?e.jsx(ne,{violationUser:s,color:t}):e.jsx("div",{className:"flex justify-center",children:e.jsx(N,{className:"colorTwo",variant:"outlined",form:"auth",children:n})})}function ae({violationUser:s,changeViolationUser:t}){const n=C(c=>c.profile.value);return n!=null&&n.certificated?e.jsxs("div",{className:"flex gap-5 pt-3 px-5",children:[e.jsx(L,{trigger:e.jsx(re,{violationUser:s}),title:e.jsx(te,{}),content:e.jsx(se,{changeViolationUser:t})}),s&&e.jsx(N,{className:"colorTwo",variant:"outlined",onClick:()=>t(null),children:e.jsx(W,{})})]}):null}const ce=()=>{const[s,t]=x.useState([]),n=C(r=>r.profile.value),{noReport:c,reportingUser:i,remove:a}=d(),h=A(w(p,"violations")),m=r=>{const o=r.id,g=M(p,`violations/${o}`);Z(g);const l=[];s.map((j,f)=>{j.id!==o&&l.push(j),f+1===s.length&&t(l)}),alert("지웠습니다")};return x.useEffect(()=>{(async()=>{const o=[];(await F(h)).forEach(l=>{if(l.data().userUid===(n==null?void 0:n.uid)){const j=l.data(),f={id:l.id,...j};o.push(f)}t(o)})})()},[]),s.length===0?e.jsx("div",{className:"flex justify-center p-5",children:e.jsx("div",{className:"rounded shadow-md bg-light-1 dark:bg-dark-1 p-5",children:c})}):e.jsx("div",{className:"p-5",children:s.map((r,o)=>e.jsx("div",{children:e.jsx(q,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(O,{value:o.toString(),children:[e.jsx(H,{className:"bg-light-1/50 dark:bg-dark-1/50 rounded shadow-md",children:r.messageTitle}),e.jsxs(X,{children:[e.jsx("div",{children:r.message}),r!=null&&r.violationUser?e.jsxs("div",{children:[e.jsx("div",{className:"pt-5",children:i}),e.jsx(E,{elements:[r.violationUser],multiple:!0,userSearch:!0,ranking:!0,handleUser:()=>{}})]}):e.jsx(Y,{variant:"inset"}),e.jsx("div",{className:"flex pt-3 justify-center",children:e.jsx(N,{className:"colorOne",variant:"outlined",onClick:()=>m(r),children:a})})]})]})})}))})},ie=()=>{const{reportList:s}=d();return e.jsx(N,{className:"colorTwo",variant:"outlined",form:"auth",children:s})};function oe(){const s=C(n=>n.profile.value),{reportList:t}=d();return s!=null&&s.certificated?e.jsx(L,{trigger:e.jsx(ie,{}),title:t,content:e.jsx(ce,{})}):null}function le(){const[s]=_(),[t,n]=x.useState({title:"",content:""}),[c,i]=x.useState(null),a=C(u=>u.profile.value),{sending:h,receiving:m,supervisor:r,send:o,reportTitle:g,reportContent:l,anonymousUser:j}=d();x.useEffect(()=>{(async()=>{const y=M(p,`members/${s.get("id")}`),D=(await z(y)).data();D&&i(D)})()},[s.get("id")]);const f=u=>{i(u)},P=async()=>{try{t.title&&t.content?(await G(w(p,"violations"),{userUid:(a==null?void 0:a.uid)||"비로그인",userName:(a==null?void 0:a.displayName)||"비로그인",messageTitle:t.title,message:t.content,violationUser:a!=null&&a.certificated?c:null}),alert("등록되었습니다"),n({title:"",content:""}),i(null)):alert("내용을 작성해주세요")}catch(u){console.log(u)}},b=u=>{const{target:{value:y,name:T}}=u;n({...t,[T]:y})};return e.jsxs("form",{id:"auth",children:[e.jsx(k,{action:h,label:a?a==null?void 0:a.displayName:j}),e.jsx(k,{action:m,label:r}),e.jsx("div",{className:"pt-5 px-5",children:e.jsx(v,{name:"title",sx:{display:"flex",justifyContent:"center"},label:g,multiline:!0,value:t.title,onChange:b,variant:"outlined",fullWidth:!0})}),e.jsx("div",{className:"pt-5 px-5",children:e.jsx(v,{name:"content",sx:{display:"flex",justifyContent:"center"},label:l,multiline:!0,rows:5,value:t.content,onChange:b,variant:"outlined",fullWidth:!0})}),e.jsx(ae,{violationUser:c,changeViolationUser:f}),e.jsxs("div",{className:"flex justify-center pt-2.5",children:[e.jsx(oe,{}),e.jsx(N,{className:"colorTwo",variant:"outlined",form:"auth",onClick:P,children:o})]})]})}function xe(){const{report:s}=d();return e.jsxs(e.Fragment,{children:[e.jsx(J,{icon:e.jsx(K,{}),title:s}),e.jsx(le,{})]})}export{xe as default};
