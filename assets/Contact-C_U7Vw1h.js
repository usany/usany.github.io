import{j as e,r,a2 as k,a1 as C,X as g,ao as T,W as E,a$ as L,a5 as v,L as I,M as B,O as R,a4 as $,ax as V,au as W,av as q,aR as O,S as P,b1 as Q,ak as X}from"./index-J0Gka_Gw.js";import{P as z}from"./PageTitle-G-kA0ark.js";import{C as G,T as y}from"./TextField-Dd1c130S.js";import{i as A,j as D,B as u,k as M,l as H,q as J}from"./index-BRm8Azre.js";import{A as K,a as Y,b as Z,c as _}from"./accordion-BEHNZvBh.js";import{L as F}from"./Lists-DBkWLmlH.js";import{C as U}from"./Card-Bm4ezuQm.js";function w({action:s,label:a}){return e.jsxs("div",{className:"px-5",children:[e.jsxs("span",{children:[s,": "]}),e.jsx(G,{label:a})]})}const ee=({userObj:s})=>{const[a,n]=r.useState([]);r.useState();const m=k(C(g,"violations")),h=t=>{const l=t.id,d=E(g,`violations/${l}`);L(d);const i=[];a.map((c,x)=>{c.id!==l&&i.push(c),x+1===a.length&&n(i)}),alert("지웠습니다")};return r.useEffect(()=>{(async()=>{const l=[];(await v(m)).forEach(i=>{if(i.data().userUid===s.uid){const c=i.data(),x={id:i.id,...c};l.push(x)}n(l)})})()},[]),console.log(a),e.jsx(e.Fragment,{children:e.jsxs(A,{children:[e.jsx(D,{children:e.jsx(u,{variant:"outlined",form:"auth",children:"신고하기 내역"})}),e.jsxs(M,{className:"bg-light-3 dark:bg-dark-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-light-2 dark:bg-dark-2 h-2 w-[100px] rounded-full bg-muted",children:" "})}),e.jsx("div",{className:"flex justify-center pt-5",children:"신고하기 내역"}),e.jsx("div",{className:"p-5",children:a.length!==0?a.map((t,l)=>e.jsx("div",{children:e.jsx(K,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(Y,{value:l.toString(),children:[e.jsx(Z,{children:t.messageTitle}),e.jsxs(_,{children:[e.jsx("div",{children:t.message}),t!=null&&t.violationUser?e.jsxs("div",{children:[e.jsx("div",{className:"pt-5",children:"신고 등록 유저"}),e.jsx(F,{elements:[t.violationUser],multiple:!0,userSearch:!0,ranking:!1,handleUser:d=>console.log(d)})]}):e.jsx(T,{variant:"inset"}),e.jsx("div",{className:"flex pt-3 justify-center",children:e.jsx(u,{variant:"outlined",onClick:()=>h(t),children:"지우기"})})]})]})})})):e.jsx("div",{children:"신고하기 내역이 없습니다."})})]})]})})};function se({violationUser:s,changeViolationUser:a}){const[n,m]=r.useState([]),[h,t]=r.useState([]),[l,d]=r.useState(""),i=c=>{const{target:{value:x}}=c;d(x)};return r.useEffect(()=>{(async()=>{const x=k(C(g,"members"),$("points","desc")),p=(await v(x)).docs.map((j,N)=>{var o;return V(W(q,`${(o=j.data())==null?void 0:o.uid}`)).then(f=>{t([...h,{url:f,index:N}])}).catch(f=>{console.log(f)}),{...j.data()}});m(p)})()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsx(D,{className:"w-screen",onClick:()=>d(""),children:s?e.jsx(U,{sx:{width:"100%",bgcolor:theme==="dark"?"#5c6778":""},children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex flex-col justify-center",children:"신고 유저:"}),e.jsx("div",{className:"px-5",children:e.jsxs(I,{className:`bg-${((s==null?void 0:s.profileColor)||[]).indexOf("#")===-1?s==null?void 0:s.profileColor:"profile-blue"}`,children:[e.jsx(B,{src:s==null?void 0:s.profileImageUrl}),e.jsx(R,{className:"text-xl border-none",children:s==null?void 0:s.displayName[0]})]})}),e.jsx("div",{className:"flex flex-col justify-center",children:s.displayName})]})}):e.jsx(u,{sx:{width:"100%"},variant:"outlined",form:"auth",children:"신고 유저 등록"})}),e.jsxs(M,{className:"h-[50%] bg-light-3 dark:bg-dark-3",children:[e.jsx(y,{label:"유저 이름",onChange:i}),l&&e.jsx(H,{className:"overflow-y-scroll",children:e.jsx("div",{className:"flex flex-col",children:e.jsx(J,{children:e.jsx(F,{elements:n,multiple:!0,userSearch:l,ranking:!1,handleUser:c=>a(c)})})})})]})]}),s&&e.jsx(u,{sx:{width:"25%"},variant:"outlined",onClick:()=>a(null),children:"신고 등록 취소"})]})}function ae({userObj:s,user:a}){const[n,m]=r.useState(""),[h,t]=r.useState(""),[l,d]=r.useState(!1),[i,c]=r.useState(null),[x,S]=r.useState(!0);r.useEffect(()=>{a&&x&&(c(a),S(!1))},[a]),r.useEffect(()=>{d(!!(n&&h))},[n,h]);const p=async()=>{try{await O(C(g,"violations"),{userUid:s.uid,userName:s.displayName,messageTitle:n,message:h,violationUser:i}),alert("등록되었습니다"),m(""),t("")}catch(o){console.log(o)}},j=o=>{const{target:{name:f,value:b}}=o;t(b)},N=o=>{const{target:{name:f,value:b}}=o;m(b)};return e.jsx(e.Fragment,{children:e.jsxs("form",{id:"auth",children:[e.jsx("div",{className:"flex justify-center pt-5 px-5",children:e.jsx(y,{label:"신고하기 제목",multiline:!0,value:n,onChange:N,variant:"outlined",fullWidth:!0})}),e.jsx("div",{className:"flex justify-center pt-5 px-5",children:e.jsx(y,{label:"신고하기 내용",multiline:!0,rows:5,value:h,onChange:j,variant:"outlined",fullWidth:!0})}),e.jsx("div",{className:"flex pt-3 px-5 gap-1",children:e.jsx(se,{violationUser:i,changeViolationUser:o=>c(o)})}),e.jsxs("div",{className:"flex justify-center pt-2.5",children:[e.jsx(ee,{userObj:s}),l?e.jsx(u,{variant:"outlined",form:"auth",onClick:p,children:"전송"}):e.jsx(u,{variant:"outlined",form:"auth",disabled:!0,children:"전송"})]})]})})}function oe({userObj:s}){const a=P(),{state:n}=Q();return r.useEffect(()=>{a(X(5))}),e.jsxs("div",{children:[e.jsx(z,{title:"신고하기"}),e.jsx(w,{action:"발신",label:s.displayName}),e.jsx(w,{action:"수신",label:"담당자"}),e.jsx(ae,{userObj:s,user:n==null?void 0:n.user})]})}export{oe as default};
