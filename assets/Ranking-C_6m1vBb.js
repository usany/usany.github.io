import{u as L,a as R,b as A,j as e,T as B,r as c,L as x,q as w,s as y,l as H,o as v,c as E,d as p,g as b,e as q,f as F,h as M,i as Q,P as I,S as $}from"./index-CAFBSCXR.js";function z(){const[t,s]=L(),o=R(u=>u.languages.value),l=u=>{const{target:{value:a}}=u;s(r=>(r.set("search",a),a||r.delete("search"),r))},{colorOne:S,colorTwo:i}=A();return e.jsx("div",{className:"px-5 flex justify-center",children:e.jsx(B,{sx:{width:"1000px",bgcolor:i,borderRadius:"5px"},label:o==="ko"?"유저 이름":"User name",onChange:l})})}function G({userObj:t}){const[s,o]=c.useState([]),[l,S]=c.useState([]),[i,u]=c.useState(null),[a,r]=c.useState(!1),[D,J]=L(),d=D.get("search"),N=20;c.useEffect(()=>{const U=async()=>{const h=w(E(p,"members"),v("points","desc"),H(N),y(i||"")),g=await b(h),m=g.docs.map((n,f)=>{if(s.indexOf(n)===-1)return f+1===g.docs.length&&u(n),{...n.data()}});if(o([...s,...m]),l.length===0){const n=q(p,`members/${t.uid}`),P=(await F(n)).data();m.map((T,j)=>{T.uid===t.uid&&(m[j].rank=j+1)}),S([P])}r(!1)},C=async()=>{const h=w(E(p,"members"),v("points","desc"),y(i||"")),g=await b(h),m=g.docs.map((n,f)=>{if(console.log(s.indexOf(n)),s.indexOf(n)===-1)return f+1===g.docs.length&&u(n),{...n.data()}});o([...s,...m]),r(!1)};(a||s.length===0)&&U(),d&&(C(),console.log(d))},[a,d]);const k=()=>{if(document.documentElement.offsetHeight-(window.innerHeight+Math.round(document.documentElement.scrollTop))>250||a){console.log(document.documentElement.offsetHeight);return}else console.log("scroll"),r(!0)};return c.useEffect(()=>(window.addEventListener("scroll",k),()=>window.removeEventListener("scroll",k)),[a]),e.jsx("div",{className:"flex truncate justify-center",children:d?e.jsx("div",{className:"w-[1000px]",children:e.jsx(x,{userObj:t,elements:s,multiple:!0,userSearch:d,ranking:!0,handleUser:null})}):e.jsxs("div",{className:"w-[1000px]",children:[e.jsx(x,{userObj:t,elements:l,multiple:!1,userSearch:null,ranking:!0,handleUser:null}),e.jsx(x,{userObj:t,elements:s,multiple:!0,userSearch:null,ranking:!0,handleUser:null}),a&&e.jsx("div",{className:"flex justify-center text-2xl bg-light-2 dark:bg-dark-2 rounded",children:"로딩"})]})})}function O({userObj:t}){const s=R(l=>l.languages.value),o=M();return c.useEffect(()=>{o(Q(5))}),e.jsxs(e.Fragment,{children:[e.jsx(I,{icon:e.jsx($,{}),title:s==="ko"?"유저 랭킹":"User Ranking"}),e.jsx(z,{}),e.jsx(G,{userObj:t})]})}export{O as default};
