import{b2 as je,u as ie,c as ae,O as pe,aV as se,r as d,j as e,P as me,b1 as fe,Y as oe,X as we,b3 as ye,aX as Pe,v as Y,m as P,I as q,$ as Q,a_ as ke,l as te,C as ee,b4 as Me,N as ue,B as ne,b5 as ze,q as ce,Z as re,_ as de,n as ge,aY as Ce,s as Ee,S as Te,Q as Ne,D as $e,b6 as Re,aJ as Fe,aa as Ve,b7 as Be,b8 as Ae,b9 as He,ba as _e}from"./index-Ctzizd9m.js";/**
 * @license lucide-react v0.381.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=je("AlarmClockCheck",[["circle",{cx:"12",cy:"13",r:"8",key:"3y4lt7"}],["path",{d:"M5 3 2 6",key:"18tl5t"}],["path",{d:"m22 6-3-3",key:"1opdir"}],["path",{d:"M6.38 18.7 4 21",key:"17xu3x"}],["path",{d:"M17.64 18.67 20 21",key:"kv2oe2"}],["path",{d:"m9 13 2 2 4-4",key:"6343dt"}]]);/**
 * @license lucide-react v0.381.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=je("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),qe={ko:"메세지를 작성해 주세요",en:"Input message"},Ke={ko:"전송",en:"send"};function Ze({chattingUser:s,userObj:g,multiple:k,messages:a,handleMessages:i,messagesList:U,handleMessagesList:c}){const S=ie(r=>r.profileColor.value),_=ie(r=>r.piazzaForm.value),n=ae(r=>r.profile.value),R=pe(),{state:j}=se(),x=j==null?void 0:j.conversation,E=ae(r=>r.languages.value),F=E==="ko"||E==="en"?E:"ko",[v,T]=d.useState(!1),$=async r=>{var z;r.preventDefault();const N=a,M=g.uid,B=g.displayName,y=Date.now(),t=new Date().toString(),l=n==null?void 0:n.profileImageUrl,o=n==null?void 0:n.defaultProfile,w=n==null?void 0:n.profileImage;let f,h,m;s&&(f=Y(P,`members/${s.uid}`),h=await q(f),m=(z=h.data())==null?void 0:z.messagingToken);const u=n.profileImage?n.profileImageUrl:n.defaultProfile;console.log(n);const p={msg:N,userUid:M,id:B,messageClockNumber:y,messageClock:t,conversation:x,conversationUid:s==null?void 0:s.uid,conversationName:s==null?void 0:s.displayName,profileImage:w,defaultProfile:o,profileImageUrl:l,profileUrl:u,sendingToken:m};k?p&&N&&(Q.emit("piazzaMessage",p),b()):N&&(U.length!==0?(Q.emit("message",p),console.log("message")):(Q.emit("messageNew",p),console.log("messageNew")),C(),V()),i("")},I=r=>{i(r.target.value)},b=async()=>{try{const r=a,N=g.uid,M=g.displayName,B=new Date().toString(),y=Date.now(),t=n==null?void 0:n.profileImageUrl,l=n==null?void 0:n.defaultProfile,o=n==null?void 0:n.profileImage;r&&(await ke(te(P,"chats_group"),{userUid:N,userName:M,message:r,messageClock:B,messageClockNumber:y,profileImageUrl:t,defaultProfile:l,profileColor:S,piazzaChecked:[g.uid],profileImage:o}),c(w=>[...w,{msg:r,type:"me",userUid:g.uid,id:g.displayName,messageClock:B,conversation:null,profileColor:S,messageClockNumber:y,defaultProfile:l,profileImageUrl:t,profileImage:o||!1}]))}catch(r){console.log(r)}},C=async()=>{var N,M,B;const r=a;try{const y=g.uid,t=g.displayName,l=Date.now(),o=new Date().toString(),w=n.profileImage,f=s.profileImage,h=n.profileImageUrl,m=s.profileImageUrl,u=n.defaultProfile,p=s.defaultProfile;let z,D,L,A,H,K,W,X,J,Z;if(g.uid<s.uid?(z=g.uid,D=s.uid,L=g.displayName,A=s.displayName,H=h,K=m,W=u,X=p,J=n.profileImage,Z=s.profileImage):(z=s.uid,D=g.uid,L=s.displayName,A=g.displayName,H=m,K=h,W=p,X=u,J=s.profileImage,Z=n.profileImage),!H){const G=Y(P,`members/${z}`);H=(N=(await q(G)).data())==null?void 0:N.profileImageUrl}if(!K){const G=Y(P,`members/${D}`);K=(M=(await q(G)).data())==null?void 0:M.profileImageUrl}if(r){const G={userUid:y,userName:t,message:r,messageClock:o,messageClockNumber:l,userOne:z,userTwo:D,userOneDisplayName:L,userTwoDisplayName:A,userOneProfileUrl:H,userTwoProfileUrl:K,userOneDefaultProfile:W,userTwoDefaultProfile:X,userOneProfileImage:J,userTwoProfileImage:Z};await ke(te(P,`chats_${x}`),G);const O=Y(P,`members/${y}`),xe=(await q(O)).data().chattings||{},ve=Y(P,`members/${s.uid}`),le=(await q(ve)).data().chattings||{},be=((B=le[x])==null?void 0:B.messageCount)||0;xe[x]=G,le[x]={...G,messageCount:be+1},await ee(O,{chattings:xe}),await ee(ve,{chattings:le}),c(Ue=>[...Ue,{msg:r,type:"me",userUid:g.uid,id:g.displayName,messageClock:o,conversation:x,userName:t,messageClockNumber:l,userOne:z,userTwo:D,userOneDisplayName:L,userTwoDisplayName:A,userOneProfileUrl:H,userTwoProfileUrl:K,userOneDefaultProfile:W,userTwoDefaultProfile:X,userOneProfileImage:J,userTwoProfileImage:Z}])}}catch(y){console.log(y)}},V=async()=>{try{const r=g.uid,N=s.uid,M=Y(P,`members/${r}`),y=(await q(M)).data().conversation||[],t=Y(P,`members/${N}`),o=(await q(t)).data().conversation||[];y.indexOf(x)===-1&&(await ee(M,{conversation:[...y,x]}),R(Me())),o.indexOf(x)===-1&&await ee(t,{conversation:[...o,x]})}catch(r){console.log(r)}};return d.useEffect(()=>{if(v){document.getElementById("mute"),document.getElementById("stream");const r=document.getElementById("videoInput");document.getElementById("myFace");let N;async function M(){try{const y={video:!0,audio:!0};N=await navigator.mediaDevices.getUserMedia(y),N.getVideoTracks().forEach(t=>t.enabled=!t.enabled),N.getAudioTracks().forEach(t=>t.enabled=!t.enabled),B()}catch(y){console.log(y)}}M();async function B(){try{const t=(await navigator.mediaDevices.enumerateDevices()).filter(l=>l.kind==="videoinput");t.forEach(l=>{const o=document.createElement("option");o.value=l.deviceId,o.innerText=l.label,r==null||r.appendChild(o)}),console.log(t)}catch(y){console.log(y)}}}}),e.jsx(e.Fragment,{children:e.jsxs("form",{className:`fixed w-screen ${_?"bottom-0":"bottom-[60px]"} flex gap-px`,onSubmit:$,children:[x&&x!=="piazza"&&e.jsx(me,{trigger:e.jsx("button",{className:"px-1 h-full rounded bg-light-2 dark:bg-dark-2",type:"submit",children:e.jsx(Ye,{})}),title:e.jsx("div",{children:"전화 선택"}),content:e.jsxs("div",{className:"flex justify-center gap-5 p-5",children:[e.jsx(fe,{children:e.jsx(oe,{to:`/piazza?id=${x}?calls=video`,children:e.jsx(we,{className:"colorOne",sx:{height:"100%"},children:e.jsx(ye,{children:e.jsxs("div",{className:"flex flex-col items-center gap-5",onClick:()=>{var r;(r=document.getElementById("calls"))==null||r.click()},children:[e.jsx(Pe,{}),e.jsx("div",{children:"화상 전화"})]})})})})}),e.jsx(fe,{children:e.jsx(oe,{to:`/piazza?id=${x}?calls=audio`,children:e.jsx(we,{className:"colorOne",sx:{height:"100%"},children:e.jsx(ye,{children:e.jsxs("div",{className:"flex flex-col items-center gap-5",children:[e.jsx(Le,{}),e.jsx("div",{children:"음성 전화"})]})})})})})]})}),e.jsx("input",{className:"w-full p-3 rounded bg-light-1 dark:bg-dark-1",placeholder:qe[F],onChange:I,value:a,autoFocus:!0}),e.jsx("button",{className:"w-1/6 rounded bg-light-2 dark:bg-dark-2",type:"submit",children:Ke[F]})]})})}const De=({initiateContinuing:s,multiple:g,handleMultiple:k,user:a,userObj:i,handleMessagesList:U,displayedName:c})=>{const{state:S}=se(),_=(S==null?void 0:S.conversation)||"piazza",n=ae(x=>x.languages.value),[R,j]=d.useState("");return d.useEffect(()=>{a&&((a==null?void 0:a.uid)<i.uid?j((a==null?void 0:a.uid[0])+(a==null?void 0:a.uid[1])+(a==null?void 0:a.uid[2])+(a==null?void 0:a.uid[3])+(a==null?void 0:a.uid[4])+(a==null?void 0:a.uid[5])+i.uid[0]+i.uid[1]+i.uid[2]+i.uid[3]+i.uid[4]+i.uid[5]):j(i.uid[0]+i.uid[1]+i.uid[2]+i.uid[3]+i.uid[4]+i.uid[5]+(a==null?void 0:a.uid[0])+(a==null?void 0:a.uid[1])+(a==null?void 0:a.uid[2])+(a==null?void 0:a.uid[3])+(a==null?void 0:a.uid[4])+(a==null?void 0:a.uid[5])))},[a]),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col items-center pt-5",children:[e.jsx(ue,{element:a,uid:i.uid,profile:!0,profileColor:"",profileUrl:a==null?void 0:a.profileImageUrl,fallback:"",piazza:null}),e.jsx("div",{children:a==null?void 0:a.displayName}),(a==null?void 0:a.displayName)!==c&&e.jsx("div",{children:n==="ko"?e.jsxs("div",{children:["(",c,"에서 개명)"]}):e.jsxs("div",{children:["(Changed name from ",c,")"]})})]}),e.jsxs("div",{className:"flex justify-center p-5",children:[e.jsx(oe,{to:`/profile?id=${a==null?void 0:a.uid}`,state:{element:a},children:e.jsx(ne,{variant:"outlined",onClick:()=>{},children:n==="ko"?"프로필 확인":"Check Profile"})}),_==="piazza"&&i.uid!==(a==null?void 0:a.uid)&&e.jsx(oe,{to:`${location.pathname}?id=${R}`,state:{conversation:R,displayName:a==null?void 0:a.displayName,userUid:i.uid,chattingUid:a==null?void 0:a.uid,multiple:!1,profileUrl:a==null?void 0:a.profileImageUrl},children:e.jsx(fe,{children:e.jsx(ne,{variant:"outlined",onClick:()=>{U([]),k(!1),s()},children:n==="ko"?"개인 대화":"Private messaging"})})})]})]})};function Ie({userObj:s,multiple:g,handleMultiple:k,messagesList:a,handleMessagesList:i}){const U=d.useRef(null),c=d.useRef(null),[S,_]=d.useState(null),[n,R]=d.useState(""),[j,x]=d.useState(!1),[E,F]=d.useState(null),[v,T]=d.useState(0),[$,I]=d.useState("piazza"),{state:b}=se(),C=(b==null?void 0:b.conversation)||"piazza";d.useEffect(()=>{$!==C&&(i([]),F(null),T(0),I(C))},[C]);const V=ae(t=>t.languages.value),r=async({userUid:t,displayName:l})=>{const o=Y(P,`members/${t}`),f=(await q(o)).data();_(f),R(l),console.log("practice")},N=({userUid:t,displayName:l})=>{var o;(o=document.getElementById("drawer"))==null||o.click(),r({userUid:t,displayName:l})},M=20;d.useEffect(()=>{if(!Q)return;function t(l){const{msg:o,userUid:w,id:f,target:h,messageClock:m,messageClockNumber:u,profileImageUrl:p,defaultProfile:z,profileImage:D,conversation:L}=l;i(A=>[...A,{msg:o,type:h?"private":"other",userUid:w,id:f,messageClock:m,messageClockNumber:u,conversation:null,profileImageUrl:p,defaultProfile:z,profileImage:D}])}return Q.on("sMessagePiazza",t),()=>{Q.off("sMessagePiazza",t)}},[]),d.useEffect(()=>{if(!Q)return;function t(l){const{msg:o,userUid:w,id:f,target:h,messageClock:m,messageClockNumber:u,conversation:p,profileImageUrl:z,defaultProfile:D,profileImage:L,piazzaData:A}=l;i(H=>[...H,{msg:o,type:h?"private":"other",userUid:w,id:f,messageClock:m,messageClockNumber:u,conversation:null,profileImageUrl:z,defaultProfile:D,profileImage:L,...A}])}return Q.on(`sMessage${C}`,t),()=>{Q.off(`sMessage${C}`,t)}},[]),d.useEffect(()=>{document.documentElement.scrollTo({top:0,left:0,behavior:"instant"})},[]),d.useEffect(()=>{B(),(async()=>{if(g){const l=te(P,"chats_group"),o=ce(l,de("messageClockNumber","desc"),re(1));(await ge(o)).forEach(async f=>{const h=Y(P,`chats_group/${f.id}`),u=(await q(h)).data(),p=u.piazzaChecked||[];p.indexOf(s.uid)===-1&&(p.splice(-1,s.uid,0),p.push(s.uid),await ee(h,{...u,piazzaChecked:p}))})}else{const l=Y(P,`members/${s.uid}`),w=(await q(l)).data().chattings;w[C]&&(w[C].messageCount=0),await ee(l,{chattings:w})}})()},[a]);const B=()=>{var t;(t=U.current)==null||t.scrollIntoView()};d.useEffect(()=>{const t=async()=>{const o=[],w=te(P,"chats_group"),f=ce(w,de("messageClockNumber","desc"),re(M),Ce(E||"")),h=await ge(f);h.docs.length||T(h.docs.length),h.forEach(m=>{var X,J,Z;o.length===h.docs.length-1&&(F(m),T(h.docs.length-1));const u=m.data().message,p=m.data().userUid,z=m.data().userName,D=m.data().messageClock,L=m.data().messageClockNumber,A=(X=m.data())==null?void 0:X.profileImageUrl,H=(J=m.data())==null?void 0:J.defaultProfile,K=(Z=m.data())==null?void 0:Z.profileImage,W=m.data();o.push({msg:u,userUid:p,id:z,messageClockNumber:L,messageClock:D,conversation:null,profileImageUrl:A,defaultProfile:H,profileImage:K||!1,...W})}),o.reverse(),i([...o,...a]),x(!1)},l=async o=>{const w=te(P,`chats_${o}`),f=ce(w,de("messageClockNumber","desc"),re(M),Ce(E||"")),h=await ge(f),m=[];h.docs.length||T(h.docs.length),h.forEach((u,p)=>{var Z,G,O;m.length===h.docs.length-1&&(F(u),T(h.docs.length-1));const z=u.data().message,D=u.data().userUid,L=u.data().userName,A=u.data().messageClock,H=u.data().messageClockNumber||0,K=(Z=u.data())==null?void 0:Z.profileImageUrl,W=(G=u.data())==null?void 0:G.defaultProfile,X=(O=u.data())==null?void 0:O.profileImage,J=u.data();m.push({msg:z,userUid:D,id:L,messageClockNumber:H,messageClock:A,conversation:null,profileImageUrl:K,defaultProfile:W,profileImage:X||!1,...J})}),m.reverse(),i([...m,...a]),x(!1)};C==="piazza"?(j||!a.length)&&t():(j||!a.length)&&l(C)},[j,C]);const y=()=>{c.current.scrollTop!==0||j||(console.log("scroll"),x(!0))};return d.useEffect(()=>{var t;return(t=c.current)==null||t.addEventListener("scroll",y),()=>{var l;return(l=c.current)==null?void 0:l.removeEventListener("scroll",y)}},[j]),console.log(C),console.log(a),console.log(S),e.jsx(e.Fragment,{children:e.jsx("div",{ref:c,className:"p-1 border-t rounded-xl overflow-auto",children:e.jsxs("ul",{children:[j&&e.jsx("div",{className:"flex justify-center bg-light-2 dark:bg-dark-2 rounded",children:"로딩"}),a.map((t,l)=>{let o;C==="piazza"?o=t:t.userUid===t.userOne?o={userUid:t.userOne,id:t.userOneDisplayName,profileImage:t.userOneProfileImage||t.profileImage,defaultProfile:t.userOneDefaultProfile||t.defaultProfile,profileImageUrl:t.userOneProfileUrl||t.profileImageUrl}:o={userUid:t.userTwo,id:t.userTwoDisplayName,profileImage:t.userTwoProfileImage||t.profileImage,defaultProfile:t.userTwoDefaultProfile||t.defaultProfile,profileImageUrl:t.userTwoProfileUrl||t.profileImageUrl};let w;const f=new Date(t.messageClock);t.userUid===s.uid?w="text-right":w="text-left";let h,m;l>0&&(h=a[l-1].userUid),l<a.length-1&&a[l+1].userUid===s.uid&&(m=new Date(a[l+1].messageClock),f.getFullYear()===m.getFullYear()&&f.getMonth()===m.getMonth()&&f.getDate()===m.getDate()&&f.getHours()===m.getHours()&&(f.getMinutes(),m.getMinutes()));let u,p=f.getHours(),z=(f.getMonth()+1).toString(),D=f.getDate().toString();return p>=13?(u="오후",p!==12&&(p=p-12)):(u="오전",p===0&&(p=p+12)),f.getMonth()+1<10&&(z="0"+z),D.length===1&&(D="0"+D),e.jsxs("li",{ref:l===v?U:null,className:w,children:[h!==t.userUid&&e.jsx("div",{children:e.jsx("div",{className:`flex justify-${t.userUid!==s.uid?"start":"end"}`,children:w==="text-left"?e.jsxs("div",{className:"flex gap-3",children:[e.jsx(me,{trigger:e.jsx(ue,{element:o,piazza:()=>N({userUid:o.userUid,displayName:o.id}),profile:!1}),title:e.jsx(ze,{}),content:e.jsx(De,{initiateContinuing:()=>F(null),multiple:g,handleMultiple:k,user:S,userObj:s,handleMessagesList:i,displayedName:n})}),e.jsx("div",{children:t.id})]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{children:t.id}),e.jsx(me,{trigger:e.jsx(ue,{element:o,piazza:()=>N({userUid:o.userUid,displayName:o.id}),profile:!1}),title:e.jsx(ze,{}),content:e.jsx(De,{initiateContinuing:()=>F(null),multiple:g,handleMultiple:k,user:S,userObj:s,handleMessagesList:i,displayedName:n})})]})})}),t.userUid!==s.uid?e.jsxs("div",{className:"flex gap-3 justify-start",children:[e.jsx("div",{className:"other rounded-tr-lg rounded-bl-lg rounded-br-lg p-1 bg-light-1 dark:bg-dark-1",children:t.msg}),e.jsxs("div",{children:[f.getFullYear(),"-",z,"-",D," ",V==="ko"&&u," ",p,":",f.getMinutes()<10&&"0",f.getMinutes(),V==="en"&&(u==="오전"?"am":"pm")]})]}):e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsxs("div",{children:[f.getFullYear(),"-",z,"-",D," ",V==="ko"&&u," ",p,":",f.getMinutes()<10&&"0",f.getMinutes(),V==="en"&&(u==="오전"?"am":"pm")]}),e.jsx("div",{className:"me rounded-tl-lg rounded-bl-lg rounded-br-lg p-1 bg-light-1 dark:bg-dark-1",children:t.msg})]})]},l)}),e.jsx("li",{ref:U})]})})})}function Ge({isKeyboardOpen:s,userObj:g,multiple:k,handleMultiple:a,messagesList:i,handleMessagesList:U}){return e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"fixed bottom-[50px] w-screen h-full bg-light-3 dark:bg-dark-3 flex flex-col pt-[120px]",children:e.jsx(Ie,{userObj:g,multiple:k,handleMultiple:a,messagesList:i,handleMessagesList:U})}):e.jsx("div",{className:"fixed bottom-[110px] w-screen h-[60%] bg-light-3 dark:bg-dark-3 flex flex-col",children:e.jsx(Ie,{userObj:g,multiple:k,handleMultiple:a,messagesList:i,handleMessagesList:U})})})}const Xe=Ee(Te)(({theme:s})=>({padding:8,"& .MuiSwitch-track":{borderRadius:22/2,"&::before, &::after":{content:'""',position:"absolute",top:"50%",transform:"translateY(-50%)",width:16,height:16},"&::before":{backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 24 24"><path fill="${encodeURIComponent(s.palette.getContrastText(s.palette.primary.main))}" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg>')`,left:12},"&::after":{backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 24 24"><path fill="${encodeURIComponent(s.palette.getContrastText(s.palette.primary.main))}" d="M19,13H5V11H19V13Z" /></svg>')`,right:12}},"& .MuiSwitch-thumb":{boxShadow:"none",width:16,height:16,margin:2}}));function Je(){const s=ae(i=>i.languages.value),g=ie(i=>i.piazzaSwitch.value),k=pe(),a=()=>{g==="true"?(window.localStorage.setItem("piazza","false"),k(Ne("false"))):(window.localStorage.setItem("piazza","true"),k(Ne("true")))};return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-sm",children:s==="ko"?"단체 대화 알림 받기":"Receive Group Messaging notice"}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Xe,{onClick:()=>a(),inputProps:{"aria-label":"ant design"},checked:g==="true"})})]})}const Se={ko:["단체 대화","개인 대화"],en:["Group Messaging","Messaging"]},Qe=({multiple:s,displayName:g})=>{const k=ae(c=>c.languages.value),a=k==="ko"||k==="en"?k:"ko",{state:i}=se(),U=(i==null?void 0:i.conversation)||"piazza";return e.jsxs("div",{className:"flex w-screen justify-between",children:[e.jsx($e,{icon:e.jsx(Re,{}),title:U==="piazza"?Se[a][0]:`${Se[a][1]} ${g}`}),s&&e.jsx("div",{className:"flex w-1/2 justify-end px-5 pt-5",children:e.jsx(Je,{})})]})};function We(){const[s,g]=d.useState([]),[k,a]=d.useState(!0),[i,U]=d.useState(!0),[c,S]=d.useState(""),[_,n]=d.useState(null),[R,j]=d.useState(null),x=Fe();document.getElementById("myScreen");const E=document.getElementById("devices"),F={audio:!0,video:!0};async function v(){const I=R;I&&I.getAudioTracks().forEach(b=>b.enabled=!b.enabled),a(!k)}async function T(){const I=R;I&&I.getVideoTracks().forEach(b=>b.enabled=!b.enabled),U(!i)}function $(){console.log(E.value),R.getTracks().forEach(b=>b.stop()),n(E.value)}return d.useEffect(()=>{async function I(){try{const V=(await navigator.mediaDevices.enumerateDevices()).filter(r=>r.kind==="videoinput");g(V)}catch(C){console.log(C)}}async function b(C){try{const r=C?{audio:!0,video:{deviceId:{exact:C}}}:F,N=await navigator.mediaDevices.getUserMedia(r),M=await navigator.mediaDevices.enumerateDevices();j(N),await I(),S("")}catch(V){console.log(V),S(V)}}b(_)},[E,_]),e.jsxs("div",{id:"myStream",children:[e.jsxs("div",{className:`flex ${!x&&"flex-col"} gap-1`,children:[e.jsx("video",{id:"myScreen",width:"320",height:"240",controls:!0,autoPlay:!0,children:e.jsx("source",{})}),e.jsx("video",{id:"yourScreen",width:"320",height:"240",controls:!0,autoPlay:!0})]}),c?e.jsx("div",{children:c.toString()}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-5",children:[e.jsx(ne,{onClick:v,children:k?"unmute":"mute"}),e.jsx(ne,{onClick:T,children:i?"turn stream on":"turn stream off"})]}),e.jsx("select",{id:"devices",onChange:$,children:s.map((I,b)=>e.jsx("option",{value:I.deviceId,children:I.label},b))})]})]})}function aa({userObj:s}){const[g,k]=d.useState(""),[a,i]=d.useState([]),U=pe(),{state:c}=se(),[S,_]=d.useState(!0),[n,R]=d.useState(!1),[j,x]=d.useState(null);c!=null&&c.conversation,console.log(c),d.useEffect(()=>{const v=async()=>{if(c!=null&&c.chattingUid){const T=Y(P,`members/${c.chattingUid}`),$=await q(T);x($.data())}};c!=null&&c.multiple||v()},[c]);const E=ie(v=>v.piazzaForm.value);d.useEffect(()=>{var T;const v=()=>{var I;const $=window.screen.height-300>(((I=window.visualViewport)==null?void 0:I.height)||window.screen.height);n!==$&&R($)};return window.addEventListener("resize",v),typeof visualViewport<"u"&&((T=window.visualViewport)==null||T.addEventListener("resize",v)),visualViewport==null||visualViewport.addEventListener("resize",v),typeof visualViewport<"u"&&(visualViewport==null||visualViewport.addEventListener("resize",v)),()=>{var $;typeof visualViewport<"u"&&(($=window.visualViewport)==null||$.removeEventListener("resize",v))}},[n]),d.useEffect(()=>{(c==null?void 0:c.multiple)!==void 0&&_(c==null?void 0:c.multiple)},[]),d.useEffect(()=>{U(Ve(5))});const F=c==null?void 0:c.displayName;return e.jsxs(e.Fragment,{children:[!n&&e.jsx(Qe,{multiple:S,displayName:F}),e.jsx(Ge,{isKeyboardOpen:E,userObj:s,multiple:S,handleMultiple:v=>_(v),messagesList:a,handleMessagesList:v=>i(v)}),e.jsx(Ze,{chattingUser:j,userObj:s,multiple:S,messages:g,handleMessages:v=>k(v),messagesList:a,handleMessagesList:v=>i(v)}),e.jsxs(Be,{children:[e.jsx(Ae,{children:e.jsx("div",{id:"calls"})}),e.jsx(He,{children:e.jsxs("div",{children:[e.jsx("div",{className:"flex gap-5",children:e.jsx(We,{})}),e.jsx(_e,{children:e.jsx("div",{children:"전화 종료"})})]})})]})]})}export{aa as default};
