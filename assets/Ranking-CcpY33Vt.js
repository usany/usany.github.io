import{d as L,_ as T,j as e,T as H,r,q as y,b1 as S,a2 as A,a3 as v,n as b,t as E,x as B,p as x,O as q,G as F,af as M,H as Q,b2 as G}from"./index-BTVWXTAi.js";import{L as p}from"./Lists-B0vGxYlG.js";import"./ban-DElUbJ4-.js";function I({changeUserSearch:t}){const a=L(o=>o.languages.value),s=o=>{const{target:{value:l}}=o;t(l)},{colorOne:i,colorTwo:c}=T();return e.jsx("div",{className:"px-5 flex justify-center",children:e.jsx(H,{sx:{width:"1000px",bgcolor:c,borderRadius:"5px"},label:a==="ko"?"유저 이름":"User name",onChange:s})})}function O({userObj:t,userSearch:a}){const[s,i]=r.useState([]),[c,o]=r.useState([]),[l,k]=r.useState(null),[u,m]=r.useState(!1),R=20;r.useEffect(()=>{const U=async()=>{const h=y(b(x,"members"),v("points","desc"),A(R),S(l||"")),d=await E(h),g=d.docs.map((n,f)=>{if(s.indexOf(n)===-1)return f+1===d.docs.length&&k(n),{...n.data()}});if(i([...s,...g]),c.length===0){const n=B(x,`members/${t.uid}`),N=(await q(n)).data();g.map((C,w)=>{C.uid===t.uid&&(g[w].rank=w+1)}),o([N])}m(!1)},D=async()=>{const h=y(b(x,"members"),v("points","desc"),S(l||"")),d=await E(h),g=d.docs.map((n,f)=>{if(console.log(s.indexOf(n)),s.indexOf(n)===-1)return f+1===d.docs.length&&k(n),{...n.data()}});i([...s,...g]),m(!1)};(u||s.length===0)&&U(),a&&(D(),console.log(a))},[u,a]);const j=()=>{if(document.documentElement.offsetHeight-(window.innerHeight+Math.round(document.documentElement.scrollTop))>250||u){console.log(document.documentElement.offsetHeight);return}else console.log("scroll"),m(!0)};return r.useEffect(()=>(window.addEventListener("scroll",j),()=>window.removeEventListener("scroll",j)),[u]),e.jsx("div",{className:"flex truncate justify-center",children:a?e.jsx("div",{children:e.jsx(p,{userObj:t,elements:s,multiple:!0,userSearch:a,ranking:!0,handleUser:null})}):e.jsxs("div",{className:"w-[1000px]",children:[e.jsx(p,{userObj:t,elements:c,multiple:!1,userSearch:null,ranking:!0,handleUser:null}),e.jsx(p,{userObj:t,elements:s,multiple:!0,userSearch:null,ranking:!0,handleUser:null}),u&&e.jsx("div",{className:"flex justify-center text-2xl bg-light-2 dark:bg-dark-2 rounded",children:"로딩"})]})})}function z({userObj:t}){const[a,s]=r.useState(""),i=L(o=>o.languages.value),c=F();return r.useEffect(()=>{c(M(5))}),e.jsxs(e.Fragment,{children:[e.jsx(Q,{icon:e.jsx(G,{}),title:i==="ko"?"유저 랭킹":"User Ranking"}),e.jsx(I,{changeUserSearch:o=>s(o)}),e.jsx(O,{userObj:t,userSearch:a})]})}export{z as default};
