import{u as U,a as L,b as Q,j as e,T as V,r as h,c as $,L as P,d as z,q as R,s as C,l as G,o as N,e as A,g as B,f as J,h as y,i as K,k as W,P as X,S as Y}from"./index-WETek65V.js";import{R as D}from"./RankingListsTitle-XZzgctKv.js";function Z(){const[n,t]=U(),{userName:g}=L(),l=o=>{const{target:{value:i}}=o;t(c=>(c.set("search",i),i||c.delete("search"),c))},{colorTwo:m}=Q(),a=n.get("search");return e.jsx("div",{className:"px-5 flex justify-center",children:e.jsx(V,{sx:{width:"1000px",bgcolor:m,borderRadius:"5px"},value:a,label:g,onChange:l})})}let F,p;function H({multiple:n}){const[t,g]=h.useState([]),[l,m]=h.useState(null),[a,o]=h.useState(!1),[i]=U(),c=20,{loading:q}=L(),r=i.get("search"),u=$(j=>j.profile.value);if(i.get("search")&&!n)return null;if(!n)return e.jsx(P,{elements:[u],userSearch:null,multiple:!1,handleUser:null});const I=z();h.useEffect(()=>{const j=async()=>{const S=R(A(y,"members"),N("points","desc"),G(c),C(l||"")),d=await B(S),b=t.length,f=d.docs.map((s,k)=>{var E,T;s.data().points!==F&&(F=s.data().points,p=b+k);const O=J(y,`members/${s==null?void 0:s.id}`),w=p?p+1:k+1;if(((E=s.data())==null?void 0:E.ranking)!==w&&n&&(console.log((T=s.data())==null?void 0:T.ranking),K(O,{ranking:w}),s.id===(u==null?void 0:u.uid)&&I(W({...u,ranking:w}))),r){for(let x=0;x<r.length;x++)if(s.data().displayName[x]!==r[x])return null}return t.indexOf(s)===-1?(k+1===d.docs.length&&m(s),{...s.data(),ranking:p+1}):null});g([...t,...f]),o(!1)},M=async()=>{const S=R(A(y,"members"),N("points","desc"),C(l||"")),d=await B(S),b=d.docs.map((f,s)=>t.indexOf(f)===-1?(s+1===d.docs.length&&m(f),{...f.data()}):null);g([...t,...b]),o(!1)};(a||t.length===0)&&j(),r&&M()},[a,r]);const v=()=>{if(document.documentElement.offsetHeight-(window.innerHeight+Math.round(document.documentElement.scrollTop))>250||a){console.log(document.documentElement.offsetHeight);return}else console.log("scroll"),o(!0)};return h.useEffect(()=>(window.addEventListener("scroll",v),()=>window.removeEventListener("scroll",v)),[a]),e.jsxs(e.Fragment,{children:[e.jsx(P,{elements:t,multiple:!0,userSearch:r,handleUser:null}),r&&a&&e.jsx("div",{className:"flex justify-center text-2xl bg-light-2 dark:bg-dark-2 rounded",children:q})]})}function se(){const{userSearch:n}=L();return e.jsxs(e.Fragment,{children:[e.jsx(X,{icon:e.jsx(Y,{}),title:n}),e.jsx(Z,{}),e.jsx(D,{multiple:!1}),e.jsx(H,{multiple:!1}),e.jsx(D,{multiple:!0}),e.jsx(H,{multiple:!0})]})}export{se as default};
